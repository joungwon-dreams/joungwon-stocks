## [2025-11-29 05:30] Phase 9.5: ì‹ ê·œì¢…ëª©ì¶”ì²œ ê²€ì¦ ì‹œìŠ¤í…œ ì„¤ê³„

### ğŸ“¢ To: Gemini (Architect) & Claude (Implementer)

Phase 9ì—ì„œ êµ¬í˜„í•œ AI Sniperë¥¼ í™•ì¥í•˜ì—¬ **ì¶”ì²œ ê²€ì¦ ì‹œìŠ¤í…œ**ì„ ì¶”ê°€í•©ë‹ˆë‹¤.

---

### ğŸ“ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              AI Sniper ì‹ ê·œì¢…ëª©ì¶”ì²œ ì‹œìŠ¤í…œ v2.0                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ MarketScan  â”‚â”€â”€â”€â–¶â”‚ AEGIS ë¶„ì„  â”‚â”€â”€â”€â–¶â”‚ PDF ìƒì„±    â”‚         â”‚
â”‚  â”‚ (1ì°¨ í•„í„°)   â”‚    â”‚ (ì‹¬ì¸µ ë¶„ì„)  â”‚    â”‚ (ì¶”ì²œ ë¦¬í¬íŠ¸) â”‚         â”‚
â”‚  â”‚ KOSPI only  â”‚    â”‚             â”‚    â”‚             â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                               â”‚                 â”‚
â”‚                                               â–¼                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚              ì¶”ì²œ ê²€ì¦ ì‹œìŠ¤í…œ (Tracker)               â”‚       â”‚
â”‚  â”‚  â€¢ ì¶”ì²œ ì‹œì  í˜„ì¬ê°€ ê¸°ë¡                              â”‚       â”‚
â”‚  â”‚  â€¢ 2ì£¼ê°„ ì¼ì¼ ê°€ê²© ì¶”ì                                â”‚       â”‚
â”‚  â”‚  â€¢ ìˆ˜ìµë¥  ê³„ì‚° ë° ë¦¬í¬íŠ¸                              â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                                 â”‚
â”‚  ì‹¤í–‰ ìŠ¤ì¼€ì¤„: 04:30 ~ 16:30 (ë§¤ 1ì‹œê°„, ë§¤ì¼)                      â”‚
â”‚  ëŒ€ìƒ ì‹œì¥: KOSPI (ì¶”í›„ KOSDAQ í™•ì¥ ê°€ëŠ¥)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ“Š ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

#### 1. ì‹ ê·œì¢…ëª© ì¶”ì²œ ì´ë ¥ í…Œì´ë¸”
```sql
CREATE TABLE new_stock_recommendations (
    id SERIAL PRIMARY KEY,
    recommended_at TIMESTAMP NOT NULL,      -- ì¶”ì²œ ì‹œê°
    stock_code VARCHAR(10) NOT NULL,        -- ì¢…ëª©ì½”ë“œ
    stock_name VARCHAR(50) NOT NULL,        -- ì¢…ëª©ëª…
    market VARCHAR(10) DEFAULT 'KOSPI',     -- KOSPI/KOSDAQ

    -- ì¶”ì²œ ì‹œì  ì •ë³´
    recommended_price INT NOT NULL,         -- ì¶”ì²œ ì‹œì  í˜„ì¬ê°€
    change_rate FLOAT,                      -- ì¶”ì²œ ì‹œì  ë“±ë½ë¥ 
    aegis_score FLOAT,                      -- AEGIS ì ìˆ˜
    scanner_score FLOAT,                    -- Scanner ì ìˆ˜

    -- ì¶”ì²œ ê·¼ê±°
    key_reasons JSONB,                      -- ["ê³¨ë“ í¬ë¡œìŠ¤", "ì™¸ì¸ìˆœë§¤ìˆ˜", ...]
    detailed_analysis TEXT,                 -- ìƒì„¸ ë¶„ì„ ë‚´ìš©

    -- ê¸°ìˆ ì  ì§€í‘œ
    rsi_14 FLOAT,
    ma_5 FLOAT,
    ma_20 FLOAT,
    golden_cross BOOLEAN DEFAULT FALSE,

    -- ìˆ˜ê¸‰ ì •ë³´
    foreigner_net BIGINT,
    institution_net BIGINT,

    -- ì¶”ì  ìƒíƒœ
    tracking_status VARCHAR(20) DEFAULT 'active',  -- active/completed/cancelled
    tracking_end_date DATE,                 -- 2ì£¼ í›„

    -- ìµœì¢… ì„±ê³¼
    final_return FLOAT,                     -- 2ì£¼ í›„ ìµœì¢… ìˆ˜ìµë¥ 
    max_return FLOAT,                       -- ê¸°ê°„ ë‚´ ìµœê³  ìˆ˜ìµë¥ 
    min_return FLOAT,                       -- ê¸°ê°„ ë‚´ ìµœì € ìˆ˜ìµë¥ 

    created_at TIMESTAMP DEFAULT NOW()
);
```

#### 2. ì¼ì¼ ê°€ê²© ì¶”ì  í…Œì´ë¸”
```sql
CREATE TABLE new_stock_tracking (
    id SERIAL PRIMARY KEY,
    recommendation_id INT REFERENCES new_stock_recommendations(id),
    tracking_date DATE NOT NULL,
    day_number INT NOT NULL,                -- D+1, D+2, ... D+14

    -- ê°€ê²© ì •ë³´
    open_price INT,
    high_price INT,
    low_price INT,
    close_price INT,
    volume BIGINT,

    -- ìˆ˜ìµë¥  ê³„ì‚°
    daily_return FLOAT,                     -- ë‹¹ì¼ ìˆ˜ìµë¥  (ì „ì¼ ëŒ€ë¹„)
    cumulative_return FLOAT,                -- ëˆ„ì  ìˆ˜ìµë¥  (ì¶”ì²œê°€ ëŒ€ë¹„)

    created_at TIMESTAMP DEFAULT NOW(),
    UNIQUE(recommendation_id, tracking_date)
);
```

#### 3. ì¸ë±ìŠ¤
```sql
CREATE INDEX idx_rec_date ON new_stock_recommendations(recommended_at);
CREATE INDEX idx_rec_status ON new_stock_recommendations(tracking_status);
CREATE INDEX idx_rec_market ON new_stock_recommendations(market);
CREATE INDEX idx_tracking_rec ON new_stock_tracking(recommendation_id);
CREATE INDEX idx_tracking_date ON new_stock_tracking(tracking_date);
```

---

### ğŸ“„ PDF ë¦¬í¬íŠ¸ êµ¬ì¡° (3ì„¹ì…˜)

#### ì„¹ì…˜ 1: ì˜¤ëŠ˜ì˜ ì¶”ì²œ ì¢…ëª© (Top 5)
```
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ìˆœìœ„â”‚ ì¢…ëª©ëª…      â”‚ í˜„ì¬ê°€   â”‚ ë“±ë½ë¥   â”‚ AEGIS â”‚ í•µì‹¬ê·¼ê±°   â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1  â”‚ ëŒ€í•œì¡°ì„     â”‚ 68,500  â”‚ +2.3%  â”‚  0.7  â”‚ ê³¨ë“ í¬ë¡œìŠ¤ â”‚
â”‚ 2  â”‚ í˜„ëŒ€ê±´ì„¤    â”‚ 67,000  â”‚ +1.5%  â”‚  0.6  â”‚ ì™¸ì¸ìˆœë§¤ìˆ˜ â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ì„¹ì…˜ 2: ì¢…ëª©ë³„ ìƒì„¸ ë¶„ì„
```
â–¶ 1. ëŒ€í•œì¡°ì„  (042660) - KOSPI
   í˜„ì¬ê°€: 68,500ì› â”‚ ë“±ë½ë¥ : +2.3% â”‚ AEGIS: 0.7
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   ğŸ” ì¶”ì²œ ê·¼ê±°:
   â€¢ ê¸°ìˆ ì : 5ì¼ì„  > 20ì¼ì„  ì •ë°°ì—´, ê³¨ë“ í¬ë¡œìŠ¤ ë°œìƒ
   â€¢ ìˆ˜ê¸‰: ì™¸êµ­ì¸ 3ì¼ ì—°ì† ìˆœë§¤ìˆ˜ (+15ì–µ)
   â€¢ RSI: 38.5 (ê³¼ë§¤ë„ ê·¼ì ‘, ë°˜ë“± ê°€ëŠ¥ì„±)
```

#### ì„¹ì…˜ 3: ê³¼ê±° ì¶”ì²œ ê²€ì¦ (ìµœê·¼ 2ì£¼)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì¶”ì²œì¼    â”‚ ì¢…ëª©ëª…   â”‚ ì¶”ì²œê°€   â”‚ í˜„ì¬ê°€   â”‚ ìˆ˜ìµë¥    â”‚ D+?    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 11/15    â”‚ ì‚¼ì„±ì „ì â”‚ 72,000  â”‚ 74,500  â”‚ +3.5%  â”‚ D+14 âœ“ â”‚
â”‚ 11/22    â”‚ SKí•˜ì´ë‹‰ â”‚ 185,000 â”‚ 188,000 â”‚ +1.6%  â”‚ D+7    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“Š ê²€ì¦ ìš”ì•½: í‰ê·  ìˆ˜ìµë¥  +2.1%, ìŠ¹ë¥  65% (13/20)
```

---

### ğŸ“ íŒŒì¼ êµ¬ì¡°

```
src/aegis/discovery/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ scanner.py          # MarketScanner (KOSPI ì˜µì…˜ ì¶”ê°€)
â”œâ”€â”€ finder.py           # OpportunityFinder (ê¸°ì¡´)
â”œâ”€â”€ tracker.py          # RecommendationTracker (ì‹ ê·œ)
â””â”€â”€ pdf_report.py       # EnhancedPDFReport (ì‹ ê·œ)

scripts/
â”œâ”€â”€ run_market_scan.py      # ìˆ˜ì • (--market ì˜µì…˜ ì¶”ê°€)
â””â”€â”€ track_recommendations.py # ì¶”ì²œ ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸ (ì‹ ê·œ)

sql/
â””â”€â”€ create_recommendation_tracking.sql  # DB ìŠ¤í‚¤ë§ˆ (ì‹ ê·œ)

reports/new_stock/
â”œâ”€â”€ aegis_picks.json        # ì¶”ì²œ ë°ì´í„° (JSON)
â”œâ”€â”€ ì‹ ê·œì¢…ëª©ì¶”ì²œ.pdf         # ë©”ì¸ ë¦¬í¬íŠ¸
â””â”€â”€ tracking/               # ì¶”ì  ë°ì´í„°
    â””â”€â”€ YYYY-MM-DD.json
```

---

### â° Cron ìŠ¤ì¼€ì¤„

```bash
# ì‹ ê·œì¢…ëª©ì¶”ì²œ (04:30 ~ 16:30, ë§¤ 1ì‹œê°„, ë§¤ì¼)
30 4-16 * * * /path/venv/bin/python /path/scripts/run_market_scan.py --market KOSPI --pdf

# ì¶”ì²œ ê²€ì¦ ì¶”ì  (18:00, ë§¤ì¼ - ì¥ ë§ˆê° í›„)
0 18 * * * /path/venv/bin/python /path/scripts/track_recommendations.py
```

---

### ğŸ”§ CLI ì˜µì…˜

```bash
# ê¸°ë³¸ ì‹¤í–‰ (KOSPIë§Œ)
python scripts/run_market_scan.py --market KOSPI --pdf

# AEGIS ì‹¬ì¸µ ë¶„ì„ í¬í•¨
python scripts/run_market_scan.py --market KOSPI --aegis --pdf

# ì¶”í›„ KOSDAQ í¬í•¨
python scripts/run_market_scan.py --market ALL --pdf
```

---

### ğŸ“‹ êµ¬í˜„ ìˆœì„œ

1. **DB ìŠ¤í‚¤ë§ˆ ìƒì„±** - `sql/create_recommendation_tracking.sql`
2. **Scanner ìˆ˜ì •** - `--market` ì˜µì…˜ ì¶”ê°€ (KOSPI/KOSDAQ/ALL)
3. **Tracker êµ¬í˜„** - `src/aegis/discovery/tracker.py`
4. **PDF ê°œì„ ** - ìƒì„¸ ë¶„ì„ + ê²€ì¦ ê²°ê³¼ ì„¹ì…˜ ì¶”ê°€
5. **Cron ë“±ë¡** - 04:30~16:30 ë§¤ì‹œê°„

---

*Last Updated: 2025-11-29 05:30*
*Author: Claude (Implementer)*
