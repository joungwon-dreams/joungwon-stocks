---
created: 2025-11-27 14:08:02
updated: 2025-11-27 14:08:02
tags: [feature, 신규종목추천, ai, gemini, 투자]
author: wonny
status: active
---

# 신규종목추천 기능

## 개요

보유하고 있지 않은 종목 중 AI 기반으로 투자 가치가 높은 종목을 발굴하는 기능.

## 핵심 특징

### 1. 4단계 파이프라인

```
Phase 1A → Phase 1B → Phase 2 → Phase 3
(SQL필터) → (기술분석) → (AI분석) → (스코어링)
```

### 2. 정량 + 정성 통합 분석

- **정량 (40%)**: PBR, PER, RSI, 이격도
- **정성 (60%)**: Gemini AI 등급, 신뢰도

### 3. S등급 발굴

극심한 저평가 종목을 S등급으로 분류:
- PBR 0.3 이하
- PER 5 이하

## 사용 방법

### 기본 실행

```bash
python 신규종목추천/run.py
```

### 옵션

```bash
# 테스트 모드 (5개 종목만)
python 신규종목추천/run.py --test

# AI 분석 스킵
python 신규종목추천/run.py --skip-ai
```

### 사전 요구사항

```bash
# PBR/PER 데이터 (매일 1회)
python scripts/collect_fundamentals_pykrx.py

# OHLCV 데이터 (매일 1회)
python scripts/collect_ohlcv_fdr.py
```

## 출력 결과

### 리포트 파일

```
reports/new_stock/추천종목_YYYY-MM-DD_HHMM.md
```

### 리포트 구성

1. **Top 10 추천 종목 테이블**
2. **S/A 등급 종목 상세 분석**
3. **등급 분포 통계**

### 리포트 예시

```markdown
## Top 10 추천 종목

| 순위 | 종목 | AI등급 | 최종점수 | 정량 | 정성 |
|:---:|:---:|:---:|:---:|:---:|:---:|
| 1 | 유성티엔에스 | S | 69.6 | 37.4 | 91.0 |
| 2 | 인터지스 | S | 69.0 | 36.0 | 91.0 |
```

## 등급 기준

| 등급 | 설명 | 조건 |
|:---:|:---|:---|
| **S** | 강력 매수 | PBR 0.3 이하 AND PER 5 이하 |
| **A** | 매수 | PBR 0.5 이하 OR PER 7 이하 |
| **B** | 관심 | PBR 1.0 이하 OR PER 15 이하 |
| **C** | 중립 | 특별한 매력 없음 |
| **D** | 관망 | 하락 리스크 존재 |

## 점수 계산

### 정량 점수 (40%)

```
quant_score = (
    pbr_score * 0.3 +
    per_score * 0.3 +
    rsi_score * 0.2 +
    disparity_score * 0.2
)
```

### 정성 점수 (60%)

```
qual_score = grade_score[ai_grade] * confidence_factor
confidence_factor = 0.7 + (ai_confidence * 0.3)
```

### 최종 점수

```
final_score = quant_score * 0.4 + qual_score * 0.6
```

## 필터 조건

### Phase 1A (SQL 필터)

| 지표 | 범위 |
|:---|:---|
| PBR | 0.1 ~ 3.0 |
| PER | 1.0 ~ 30.0 |
| 거래량 | > 10,000 |
| 보유 종목 | 제외 |

### Phase 1B (기술적 필터)

| 지표 | 범위 |
|:---|:---|
| RSI(14) | 20 ~ 80 |
| 이격도(20일) | <= 115% |
| 이격도(60일) | <= 120% |

## 설정 변경

### 필터 조건 완화

```python
# 신규종목추천/config/settings.py

@dataclass
class Phase1AConfig:
    pbr_max: float = 5.0     # 3.0 → 5.0
    per_max: float = 50.0    # 30.0 → 50.0
```

### 분석 종목 수 변경

```python
@dataclass
class Phase1BConfig:
    max_candidates: int = 200  # 100 → 200
```

### 점수 가중치 변경

```python
@dataclass
class Phase3Config:
    quant_weight: float = 0.5  # 정량 50%
    qual_weight: float = 0.5   # 정성 50%
```

## 성능

| 항목 | 값 |
|:---|:---|
| 전체 소요 시간 | ~8분 |
| 분석 종목 수 | 100개 |
| API 호출 | 20회 (Gemini) |

## 관련 문서

- [[../changelog/2025-11-27-신규종목추천-시스템]]
- [[../troubleshooting/신규종목추천-오류]]

## 향후 개선

- [ ] 수급 데이터 (기관/외국인) 연동
- [ ] 뉴스 감성 분석 점수화
- [ ] 백테스트 기능
- [ ] 실시간 알림
